# ▣ 데이터베이스 기초

## 관계형 DB의 기본개념

1. 데이터베이스는 최소한의 의미를 가지는 테이블들로 구성되며, 그 Table들에 들어있는 field로 연결한 것이다.

1. 관계는 두 테이블 사이에서 존재하며, 업무의 흐름에 따른 연관성을 지니고 있다.

1. 부모테이블과 자식테이블 구분은 주체 즉, "누가 먼저 데이터로 관리되어야 하는가?"로 판단한다.

## 스키마

1. 전체적인 DB(테이블) 구조를 정의
1. 논리적 구조와 제약조건
1. (컬럼)도메인 - 컬럼이 가질 수 있는 값의 영역

## ERD (Entity Relationship Diagram)

1.  엔티티(Table)간의 상호관계를 그림으로 도식화한 것
1.  두 엔티티에 공유속성이 있을때 '두 엔티티는 관계가 있다'라고 말한다.

        #_(unique) - 중복되면 안되는 것
        _(mandatory) - 꼭 있어야 하는 것
        o(optional) - 있어도 되고 없어도 되는 것

1.  Foreign Key(외래키)는 Parent Table과 연결고리 역할을 한다.
1.  1:1 관계일 경우 두 엔티티를 하나로 합쳐도 된다. (예: 학생 - 신체정보)
1.  1:1, m:n 관계가 성립한다고 할지라도 효율적인 데이터베이스 프로세싱을 위해서는 1:m 관계로 변형하는 것이 좋다.
1.  의미적으로 m:n 관계가 성립한다면 '미완성 모델' 이므로 관리할 수 있는 정보를 별도로 떼어내어 하나의 엔티티를 구성한 다음, 이 엔티티를 중심으로 1:m 관계를 새로 정립하는 것이 좋다. (예: 코드 - 수강생)

## 무결성

1. 데이터에 결함이 없다는 것을 의미 - 중복X, 타입(데이터형식)준수
1. 이를 위반하는 데이터가 들어오면 거절한다 -> 무결성 유지

## 참조무결성

1. ParentTable 과 DependentTable이 적절한 데이터를 유지할 수 있도록 몇가지 제한을 가해 데이터의 무결성을 유지하도록 하는 것이 참조무결성의 목적이다.

1. 데이터 삭제규칙, 갱신규칙 : 외래키 컬럼값은 주키 컬럼값중 하나이어야 한다.
1. 데이터 삭제규칙
   1. 삭제제한 - DependentTable에서 참조하고 있는 값이 있으면 레코드를 삭제할 수 없다.
   2. Null값 대체 - ParentTable에서 삭제한 값을 DependentTable에서 참조하고 있을 때 Not Null이 아닌 경우에는 그 값을 null로 바꿔준다.
   3. 계층적삭제 - ParentTable의 row를 삭제하면서 관련있는 DependentTable의 row도 함께 삭제한다.

## Index

1.  수십만개의 행을 가지고 있으면 각 행을 조사하기 때문에 많은 시간을 요구하게 된다. 이러한 경우에 index를 정의하게 되면 처리속도가 훨씬 빠르게 수행된다.
1.  무엇보다 index는 select문의 처리를 최적화 하기 위해 사용된다.

1.  index에 관한 내용은 select문에서 명시적으로 표현하지 않는다.

1.  명령문을 처리할 때 SQL은 이미 존재하는 index가 사용될 것인지 선택한다.

1.  index는 언제든지 생성되거나 삭제될 수 있다.

1.  행을 추가하거나 삭제, 갱신이 발생할 때 SQL은 테이블에 관련된 index를 유지한다. index 사용시; select 문의 처리시간은 감소하지만, 반대로 insert, update, delete문의 시간은 증가하게 된다.

1.  Primary Key로 설정되는 컬럼은 기본적으로 unique한 clustered index가 설정된다.

        1. 조회의 조건에 자주 등장하는 컬럼에 인덱스를 정의하자.
        2. 조회의 조건에 포함되는 컬럼을 가공하지 말자.
        3. 만약 가공하면 인덱스에 대한 도움을 전혀 받지 못한다.(성능저하)

## Transaction

1. 작업의 처리단위를 transaction 이라고 한다.
1. 트랜잭션은 기본적으로 입력/수정/삭제를 하는 시점에 발생한다.
1. 예를들어 데이터가 입력되어지는 시점부터 작업이 끝나는 시점을 트랜잭션이라고 한다.

### 암시적 트랜잭션

1. 사용자가 트랜잭션의 시작을 직접 정의하지 않는다. 각 트랜잭션을 commit, rollback 하기만 하면 된다.

1. 기본적으로 DB서버가 트랜잭션의 시작은 정의하지만 끝은 사용자가 정의할 수 있도록 세팅하겠다 라는 하는 것이다.

### 명시적 트랜잭션

1. 개발자가 직접 트랜잭션의 시작과 끝을 정의한다.
1. commit, rollback 으로 트랜잭션을 종료한다.
